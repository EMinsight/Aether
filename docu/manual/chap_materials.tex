\chapter{The Materials Library}
\label{matsection}

\section{Constant materials}

Those are the most simple materials. They are characterized by a real, constant refractive index for every wavelength. They are first defined through the \lfc{set\_constant}() function, and the refractive index is then specified through either the \lfc{index\_infty}(\lft{index}) function, or the \lfc{epsilon\_infty}(\lft{epsilon}) function, $\varepsilon_r$ being the argument in the latter case.\\ Example:

\begin{lstlisting}
set_constant()
index_infty(1.5)
\end{lstlisting}

As explained in \ref{fdtd_fc_material}, in the case of a constant material the whole material script can also be replaced in the main script by a call to \lfc{const\_material}.

\section{Simple dispersive materials}

Those are the simplest models that are used to define materials like glasses in the spectral range where they are transparent. \textcolor{red}{Those materials are not FDTD compatible.}

\subsection{Cauchy}

\subsection{Sellmeier terms}

The Sellmeier formula is usually written as
\begin{equation}
	n^2=1+\sum_i \frac{B_i \lambda^2}{\lambda^2-C_i}
\end{equation}
but since $n^2=\varepsilon$, it can be understood as 
\begin{equation}
	\varepsilon=1+\sum_i \epsilon^\textrm{SM}_i ~~~~ ; ~~~~ \epsilon^\textrm{SM}_i=\frac{B_i \lambda^2}{\lambda^2-C_i}
\end{equation}
where each $\epsilon^\textrm{SM}_i$ resembles a Lorentz model.

Since $C_i$ obviously must have a dimension of m$^2$, it was decided it would be simpler for Aether to write $\epsilon^\textrm{SM}$ as
\begin{equation}
	\epsilon^\textrm{SM}_i=\frac{B_i \lambda^2}{\lambda^2-C_i^2}
\end{equation}
so that $C_i$ and $\lambda$ are homogeneous.

As such each Sellmeier term is added to the material dielectric model with the function \lfc{add\_sellmeier(\lft{B},\lft{C})}, where $\lft{C}$ is the square-root of what is usually found in material databases.

\section{Absorbing dispersive materials}

	Those materials are another kind of elementary material, mostly used to describe metals. They are implemented in the software through the recursive convolution method \cite{Luebbers:90}.
	
	First, the material is set as dielectric through the \lfc{set\_dielectric}() function. \lft{$\varepsilon_\infty$} is then defined thanks to \lfc{epsilon\_infty}(\lft{$\varepsilon_\infty$}). This value is real. The full dielectric model can be a combination of the elementary dielectric models, and is thus defined through successive calls of the \lfc{add\_drude}, \lfc{add\_lorentz} or \lfc{add\_crit\_points} functions. As the number of elementary dielectric models increases, so will the amount of needed computer memory, and the computation time.
	
	Finally, the \lfc{evaluate}(\lin{Nl},\lft{$\lambda_1$},\lft{$\lambda_2$}) function evualuates the dielectric model between \lft{$\lambda_1$} and \lft{$\lambda_2$} with \lin{Nl} sampling points. The result is written in a file called \lsgnq{mat\_eval.m}. It can be loaded in MatLab or GNU Octave.

\subsection{Drude model}

This basic model is very useful to describe metals in the infrared part of the spectrum. It is defined by
\begin{equation}
\varepsilon(\omega)=\varepsilon_\infty-\frac{\dsp \omega_D^2}{\dsp \omega^2+i\gamma\omega}
\end{equation}
and is turned into through \lfc{add\_drude}(\lft{$\omega_D$},\lft{$\gamma$}). This model is FDTD compatible.

\subsection{Lorentz model}

Another basic model useful for the description of metals, defined by
\begin{equation}
\varepsilon(\omega)=\varepsilon_\infty+A\frac{\dsp \Omega^2}{\dsp \Omega^2-\omega^2-i\Gamma\omega}
\end{equation}
it is defined through \lfc{add\_lorentz}(\lft{$A$},\lft{$\Omega$},\lft{$\Gamma$}) This model is FDTD compatible.

\subsection{Critical points model}

This model was initially introduced to described the permittivity of gold in the blue part of the spectrum \cite{Etchegoin:06}, and was then adapted to FDTD by \cite{Vial:07}. Its dielectric function is
	
\begin{equation}
\varepsilon(\omega)=\varepsilon_\infty+A\Omega\left(\frac{\dsp e^{\dsp i\varphi}}{\dsp \Omega-\omega-i\Gamma}+\frac{\dsp e^{\dsp -i\varphi}}{\dsp \Omega+\omega+i\Gamma}\right)
\end{equation}
and this model is used through \lfc{add\_crit\_point}(\lft{$A$},\lft{$\Omega$},\lft{$\varphi$},\lft{$\Gamma$}). This model is FDTD compatible.

\subsection{Full example}

The following example defines a gold dielectric model from 400 to 1000 nm. The permittivity first is set to 1.03, and a drude model and two critical points models are then added. The validity range is then set based on the original data fit.

\begin{lstlisting}
set_dielectric()

epsilon_infty(1.03)
add_drude(1.3064e16,1.1274e14)
add_crit_point(0.86822,4.0812e15,-0.60756,7.3277e14)
add_crit_point(1.3700,6.4269e15,-0.087341,6.7371e14)

validity_range(400e-9,1000e-9)
\end{lstlisting}

\section{Data table based materials}

%	Dans le cas où les propriétés du matériau ne sont pas connues analytiquement mais tabulées, il est possible de définir un modèle interpolant ces données par des splines cubiques. Le matériau est alors simplement défini par la fonction \lfc{set\_data\_file}(\lsg{file}) où \lsg{file} est le chemin vers le fichier de données. Ce chemin est soit relatif au programme, soit relatif au script de matériau.
%	
%	Le fichier de données doit être composé de trois colonnes séparées par des espaces, la première étant la longueur d'onde \textcolor{red}{en mètres}, la seconde la partie réelle de l'indice et la troisième sa partie imaginaire.
%	
%	\textbf{\textcolor{red}{Attention: ce matériau n'est pas compatible avec la FDTD.}}
\fwarn
\begin{lstlisting}
set_data_file("data/Si_400_1000.dat")
\end{lstlisting}